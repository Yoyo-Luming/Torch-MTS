METRLA
Trainset:	x-(23974, 12, 207, 3)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 3)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 3)	y-(6850, 12, 207, 1)

--------- STAttention ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        10,
        50
    ],
    "lr_decay_rate": 0.1,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "steps_per_day": 288,
        "input_dim": 1,
        "output_dim": 1,
        "input_embedding_dim": 12,
        "tod_embedding_dim": 12,
        "dow_embedding_dim": 12,
        "adaptive_embedding_dim": 60,
        "feed_forward_dim": 128,
        "num_heads": 4,
        "num_layers": 3,
        "dropout": 0.1
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STAttention                              --                        --
├─Linear: 1-1                            [64, 12, 207, 12]         24
├─Embedding: 1-2                         [64, 12, 207, 12]         3,456
├─Embedding: 1-3                         [64, 12, 207, 12]         84
├─LayerNorm: 1-4                         [64, 12, 207, 96]         192
├─Sequential: 1-5                        [64, 12, 207, 96]         --
│    └─Linear: 2-1                       [64, 12, 207, 128]        12,416
│    └─ReLU: 2-2                         [64, 12, 207, 128]        --
│    └─Linear: 2-3                       [64, 12, 207, 96]         12,384
├─LayerNorm: 1-6                         [64, 12, 207, 96]         192
├─Linear: 1-7                            [64, 96, 207, 12]         156
├─Linear: 1-8                            [64, 12, 207, 1]          97
==========================================================================================
Total params: 29,001
Trainable params: 29,001
Non-trainable params: 0
Total mult-adds (M): 1.86
==========================================================================================
Input size (MB): 1.91
Forward/backward pass size (MB): 698.22
Params size (MB): 0.12
Estimated Total Size (MB): 700.25
==========================================================================================

Loss: MaskedMAELoss

2023-04-14 10:08:17.136012 Epoch 1  	Train Loss = 5.07771 Val Loss = 3.88694
2023-04-14 10:08:27.564329 Epoch 2  	Train Loss = 3.81460 Val Loss = 3.53770
2023-04-14 10:08:37.982192 Epoch 3  	Train Loss = 3.59637 Val Loss = 3.37574
2023-04-14 10:08:48.348412 Epoch 4  	Train Loss = 3.48549 Val Loss = 3.28086
2023-04-14 10:08:58.722148 Epoch 5  	Train Loss = 3.40381 Val Loss = 3.23277
2023-04-14 10:09:07.979647 Epoch 6  	Train Loss = 3.35729 Val Loss = 3.19948
2023-04-14 10:09:17.780193 Epoch 7  	Train Loss = 3.29885 Val Loss = 3.17993
2023-04-14 10:09:27.305584 Epoch 8  	Train Loss = 3.26411 Val Loss = 3.16545
2023-04-14 10:09:37.664525 Epoch 9  	Train Loss = 3.23214 Val Loss = 3.13908
2023-04-14 10:09:48.017516 Epoch 10  	Train Loss = 3.20712 Val Loss = 3.14549
2023-04-14 10:09:58.463366 Epoch 11  	Train Loss = 3.15964 Val Loss = 3.09503
2023-04-14 10:10:08.817486 Epoch 12  	Train Loss = 3.15280 Val Loss = 3.09683
2023-04-14 10:10:19.187792 Epoch 13  	Train Loss = 3.15022 Val Loss = 3.09366
2023-04-14 10:10:29.354744 Epoch 14  	Train Loss = 3.14561 Val Loss = 3.08443
2023-04-14 10:10:39.684130 Epoch 15  	Train Loss = 3.14296 Val Loss = 3.08726
2023-04-14 10:10:49.726813 Epoch 16  	Train Loss = 3.13970 Val Loss = 3.09325
2023-04-14 10:11:00.158857 Epoch 17  	Train Loss = 3.13637 Val Loss = 3.08380
2023-04-14 10:11:10.634704 Epoch 18  	Train Loss = 3.13349 Val Loss = 3.08854
2023-04-14 10:11:21.094749 Epoch 19  	Train Loss = 3.13040 Val Loss = 3.08384
2023-04-14 10:11:31.547320 Epoch 20  	Train Loss = 3.12712 Val Loss = 3.08351
2023-04-14 10:11:42.127928 Epoch 21  	Train Loss = 3.12509 Val Loss = 3.08471
2023-04-14 10:11:52.587397 Epoch 22  	Train Loss = 3.12139 Val Loss = 3.07752
2023-04-14 10:12:03.042097 Epoch 23  	Train Loss = 3.11907 Val Loss = 3.07954
2023-04-14 10:12:13.484883 Epoch 24  	Train Loss = 3.11624 Val Loss = 3.07906
2023-04-14 10:12:23.966749 Epoch 25  	Train Loss = 3.11460 Val Loss = 3.07177
2023-04-14 10:12:34.473588 Epoch 26  	Train Loss = 3.11142 Val Loss = 3.06621
2023-04-14 10:12:44.982209 Epoch 27  	Train Loss = 3.10948 Val Loss = 3.07265
2023-04-14 10:12:55.504335 Epoch 28  	Train Loss = 3.10670 Val Loss = 3.07492
2023-04-14 10:13:05.993662 Epoch 29  	Train Loss = 3.10413 Val Loss = 3.07023
2023-04-14 10:13:16.460089 Epoch 30  	Train Loss = 3.10366 Val Loss = 3.06949
2023-04-14 10:13:26.925062 Epoch 31  	Train Loss = 3.10125 Val Loss = 3.07396
2023-04-14 10:13:37.418402 Epoch 32  	Train Loss = 3.09850 Val Loss = 3.07762
2023-04-14 10:13:48.113768 Epoch 33  	Train Loss = 3.09666 Val Loss = 3.06757
2023-04-14 10:13:58.611144 Epoch 34  	Train Loss = 3.09474 Val Loss = 3.07937
2023-04-14 10:14:09.089796 Epoch 35  	Train Loss = 3.09383 Val Loss = 3.07135
2023-04-14 10:14:19.586364 Epoch 36  	Train Loss = 3.08994 Val Loss = 3.06955
2023-04-14 10:14:30.067544 Epoch 37  	Train Loss = 3.08964 Val Loss = 3.07287
2023-04-14 10:14:40.566743 Epoch 38  	Train Loss = 3.08733 Val Loss = 3.06200
2023-04-14 10:14:51.054163 Epoch 39  	Train Loss = 3.08597 Val Loss = 3.06739
2023-04-14 10:15:01.505306 Epoch 40  	Train Loss = 3.08451 Val Loss = 3.07069
2023-04-14 10:15:11.980690 Epoch 41  	Train Loss = 3.08162 Val Loss = 3.06244
2023-04-14 10:15:22.541186 Epoch 42  	Train Loss = 3.08040 Val Loss = 3.06429
2023-04-14 10:15:33.184370 Epoch 43  	Train Loss = 3.07911 Val Loss = 3.07021
2023-04-14 10:15:43.691569 Epoch 44  	Train Loss = 3.07789 Val Loss = 3.07118
2023-04-14 10:15:54.165660 Epoch 45  	Train Loss = 3.07572 Val Loss = 3.06614
2023-04-14 10:16:04.670118 Epoch 46  	Train Loss = 3.07505 Val Loss = 3.06003
2023-04-14 10:16:15.167615 Epoch 47  	Train Loss = 3.07337 Val Loss = 3.05519
2023-04-14 10:16:25.670962 Epoch 48  	Train Loss = 3.07160 Val Loss = 3.06207
2023-04-14 10:16:36.109943 Epoch 49  	Train Loss = 3.07135 Val Loss = 3.06809
2023-04-14 10:16:46.611627 Epoch 50  	Train Loss = 3.06916 Val Loss = 3.05491
2023-04-14 10:16:57.115789 Epoch 51  	Train Loss = 3.06224 Val Loss = 3.05853
2023-04-14 10:17:07.635136 Epoch 52  	Train Loss = 3.06121 Val Loss = 3.05817
2023-04-14 10:17:18.090469 Epoch 53  	Train Loss = 3.06165 Val Loss = 3.05998
2023-04-14 10:17:28.615997 Epoch 54  	Train Loss = 3.06171 Val Loss = 3.05748
2023-04-14 10:17:39.090806 Epoch 55  	Train Loss = 3.06105 Val Loss = 3.05721
2023-04-14 10:17:49.564172 Epoch 56  	Train Loss = 3.06048 Val Loss = 3.05903
2023-04-14 10:17:59.809312 Epoch 57  	Train Loss = 3.06049 Val Loss = 3.05867
2023-04-14 10:18:10.286717 Epoch 58  	Train Loss = 3.06022 Val Loss = 3.05849
2023-04-14 10:18:20.710171 Epoch 59  	Train Loss = 3.06009 Val Loss = 3.05298
2023-04-14 10:18:31.120500 Epoch 60  	Train Loss = 3.06019 Val Loss = 3.06311
2023-04-14 10:18:41.620546 Epoch 61  	Train Loss = 3.06062 Val Loss = 3.06112
2023-04-14 10:18:52.044468 Epoch 62  	Train Loss = 3.05996 Val Loss = 3.06044
2023-04-14 10:19:02.538590 Epoch 63  	Train Loss = 3.06033 Val Loss = 3.05769
2023-04-14 10:19:13.042746 Epoch 64  	Train Loss = 3.05929 Val Loss = 3.05833
2023-04-14 10:19:23.512352 Epoch 65  	Train Loss = 3.05952 Val Loss = 3.05994
2023-04-14 10:19:34.035438 Epoch 66  	Train Loss = 3.05931 Val Loss = 3.06085
2023-04-14 10:19:44.409025 Epoch 67  	Train Loss = 3.05912 Val Loss = 3.05796
2023-04-14 10:19:54.646877 Epoch 68  	Train Loss = 3.05853 Val Loss = 3.06169
2023-04-14 10:20:05.102723 Epoch 69  	Train Loss = 3.05910 Val Loss = 3.05940
2023-04-14 10:20:15.550672 Epoch 70  	Train Loss = 3.05843 Val Loss = 3.05670
2023-04-14 10:20:26.030563 Epoch 71  	Train Loss = 3.05814 Val Loss = 3.05882
2023-04-14 10:20:36.576672 Epoch 72  	Train Loss = 3.05890 Val Loss = 3.05650
2023-04-14 10:20:46.936812 Epoch 73  	Train Loss = 3.05830 Val Loss = 3.05878
2023-04-14 10:20:57.075583 Epoch 74  	Train Loss = 3.05738 Val Loss = 3.06012
2023-04-14 10:21:07.141581 Epoch 75  	Train Loss = 3.05775 Val Loss = 3.05946
2023-04-14 10:21:17.210611 Epoch 76  	Train Loss = 3.05747 Val Loss = 3.05987
2023-04-14 10:21:27.592150 Epoch 77  	Train Loss = 3.05765 Val Loss = 3.05679
2023-04-14 10:21:38.082529 Epoch 78  	Train Loss = 3.05748 Val Loss = 3.05932
2023-04-14 10:21:48.601495 Epoch 79  	Train Loss = 3.05721 Val Loss = 3.06108
Early stopping at epoch: 79
Best at epoch 59:
Train Loss = 3.06009
Train RMSE = 6.12680, MAE = 3.05692, MAPE = 8.53135
Val Loss = 3.05298
Val RMSE = 6.27946, MAE = 3.10436, MAPE = 9.04148
--------- Test ---------
All Steps RMSE = 6.53718, MAE = 3.27584, MAPE = 9.63030
Step 1 RMSE = 4.45331, MAE = 2.50709, MAPE = 6.51494
Step 2 RMSE = 5.17726, MAE = 2.74006, MAPE = 7.37207
Step 3 RMSE = 5.66351, MAE = 2.91036, MAPE = 8.02845
Step 4 RMSE = 6.03607, MAE = 3.05518, MAPE = 8.61703
Step 5 RMSE = 6.33445, MAE = 3.18379, MAPE = 9.16190
Step 6 RMSE = 6.58091, MAE = 3.29881, MAPE = 9.66619
Step 7 RMSE = 6.79270, MAE = 3.40038, MAPE = 10.12944
Step 8 RMSE = 6.98096, MAE = 3.48918, MAPE = 10.54668
Step 9 RMSE = 7.15383, MAE = 3.56777, MAPE = 10.90714
Step 10 RMSE = 7.32343, MAE = 3.64415, MAPE = 11.23535
Step 11 RMSE = 7.48556, MAE = 3.71719, MAPE = 11.54052
Step 12 RMSE = 7.64999, MAE = 3.79626, MAPE = 11.84421
Inference time: 0.97 s
