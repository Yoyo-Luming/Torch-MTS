METRLA
Trainset:	x-(23974, 12, 207, 3)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 3)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 3)	y-(6850, 12, 207, 1)

--------- STMetaGCRU ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.0001,
    "weight_decay": 0,
    "early_stop": 20,
    "milestones": [
        40,
        80
    ],
    "clip_grad": false,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "pass_device": true,
    "model_args": {
        "device": "cuda:0",
        "num_nodes": 207,
        "node_emb_file": "../data/METRLA/spatial_embeddings.npz",
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "adj_type": "doubletransition",
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "gru_hidden_dim": 32,
        "tod_embedding_dim": 24,
        "dow_embedding_dim": 7,
        "node_embedding_dim": 64,
        "learner_hidden_dim": 128,
        "z_dim": 32,
        "num_layers": 1,
        "seq2seq": false,
        "cheb_k": 3
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STMetaGCRU                               [64, 12, 207, 1]          13,248
├─Sequential: 1-1                        [64, 207, 32]             --
│    └─Linear: 2-1                       [64, 207, 32]             416
│    └─Tanh: 2-2                         [64, 207, 32]             --
│    └─Linear: 2-3                       [64, 207, 32]             1,056
│    └─Tanh: 2-4                         [64, 207, 32]             --
│    └─Linear: 2-5                       [64, 207, 32]             1,056
├─Sequential: 1-2                        [64, 207, 32]             --
│    └─Linear: 2-6                       [64, 207, 32]             416
│    └─Tanh: 2-7                         [64, 207, 32]             --
│    └─Linear: 2-8                       [64, 207, 32]             1,056
│    └─Tanh: 2-9                         [64, 207, 32]             --
│    └─Linear: 2-10                      [64, 207, 32]             1,056
├─ModuleList: 1-3                        --                        --
│    └─STMetaGCRUEncoder: 2-11           [64, 12, 207, 32]         --
│    │    └─Sequential: 3-1              [64, 207, 12672]          1,651,072
│    │    └─Sequential: 3-2              [64, 207, 64]             24,640
│    │    └─Sequential: 3-3              [64, 207, 6336]           833,728
│    │    └─Sequential: 3-4              [64, 207, 32]             20,512
│    │    └─STMetaGCRUCell: 3-5          [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-6          [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-7          [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-8          [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-9          [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-10         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-11         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-12         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-13         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-14         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-15         [64, 207, 32]             --
│    │    └─STMetaGCRUCell: 3-16         [64, 207, 32]             --
├─Linear: 1-4                            [64, 207, 12]             396
==========================================================================================
Total params: 2,548,652
Trainable params: 2,548,652
Non-trainable params: 0
Total mult-adds (M): 162.27
==========================================================================================
Input size (MB): 1.91
Forward/backward pass size (MB): 2100.60
Params size (MB): 10.14
Estimated Total Size (MB): 2112.65
==========================================================================================

Loss: MaskedMAELoss

2023-04-18 17:36:03.084600 Epoch 1  	Train Loss = 5.79531 Val Loss = 4.32503
2023-04-18 17:37:19.779641 Epoch 2  	Train Loss = 4.16396 Val Loss = 3.82368
2023-04-18 17:38:37.936459 Epoch 3  	Train Loss = 3.85578 Val Loss = 3.60068
2023-04-18 17:39:56.933346 Epoch 4  	Train Loss = 3.70259 Val Loss = 3.48565
2023-04-18 17:41:16.491580 Epoch 5  	Train Loss = 3.61801 Val Loss = 3.42556
2023-04-18 17:42:35.716297 Epoch 6  	Train Loss = 3.55653 Val Loss = 3.36283
2023-04-18 17:43:53.676839 Epoch 7  	Train Loss = 3.50579 Val Loss = 3.32016
2023-04-18 17:45:11.620105 Epoch 8  	Train Loss = 3.46325 Val Loss = 3.28356
2023-04-18 17:46:29.890098 Epoch 9  	Train Loss = 3.42922 Val Loss = 3.25012
2023-04-18 17:47:48.358062 Epoch 10  	Train Loss = 3.39197 Val Loss = 3.22631
2023-04-18 17:49:07.191341 Epoch 11  	Train Loss = 3.36062 Val Loss = 3.18946
2023-04-18 17:50:26.727269 Epoch 12  	Train Loss = 3.33197 Val Loss = 3.17277
2023-04-18 17:51:45.747072 Epoch 13  	Train Loss = 3.30346 Val Loss = 3.17346
2023-04-18 17:53:04.511107 Epoch 14  	Train Loss = 3.27769 Val Loss = 3.13628
2023-04-18 17:54:23.908193 Epoch 15  	Train Loss = 3.25641 Val Loss = 3.11233
2023-04-18 17:55:43.071755 Epoch 16  	Train Loss = 3.23789 Val Loss = 3.09748
2023-04-18 17:57:01.880015 Epoch 17  	Train Loss = 3.21541 Val Loss = 3.09555
2023-04-18 17:58:19.570632 Epoch 18  	Train Loss = 3.20483 Val Loss = 3.07874
2023-04-18 17:59:37.266714 Epoch 19  	Train Loss = 3.18064 Val Loss = 3.05753
2023-04-18 18:00:55.259676 Epoch 20  	Train Loss = 3.16321 Val Loss = 3.04696
2023-04-18 18:02:13.616637 Epoch 21  	Train Loss = 3.14644 Val Loss = 3.04013
2023-04-18 18:03:32.161604 Epoch 22  	Train Loss = 3.13174 Val Loss = 3.04183
2023-04-18 18:04:51.227258 Epoch 23  	Train Loss = 3.11213 Val Loss = 3.00950
2023-04-18 18:06:09.905462 Epoch 24  	Train Loss = 3.09558 Val Loss = 3.01114
2023-04-18 18:07:28.450126 Epoch 25  	Train Loss = 3.08000 Val Loss = 2.99455
2023-04-18 18:08:47.609402 Epoch 26  	Train Loss = 3.06700 Val Loss = 2.99479
2023-04-18 18:10:06.507216 Epoch 27  	Train Loss = 3.05278 Val Loss = 2.99516
2023-04-18 18:11:57.341306 Epoch 28  	Train Loss = 3.05430 Val Loss = 2.99455
2023-04-18 18:13:14.636838 Epoch 29  	Train Loss = 3.03595 Val Loss = 2.98635
2023-04-18 18:14:32.538153 Epoch 30  	Train Loss = 3.04982 Val Loss = 3.04476
2023-04-18 18:15:51.024682 Epoch 31  	Train Loss = 3.04787 Val Loss = 2.98927
2023-04-18 18:17:10.046867 Epoch 32  	Train Loss = 3.03801 Val Loss = 2.99870
2023-04-18 18:18:30.085187 Epoch 33  	Train Loss = 3.03706 Val Loss = 3.00949
2023-04-18 18:19:50.516203 Epoch 34  	Train Loss = 3.03486 Val Loss = 3.01100
2023-04-18 18:21:10.494201 Epoch 35  	Train Loss = 3.03060 Val Loss = 3.00361
2023-04-18 18:22:30.627407 Epoch 36  	Train Loss = 3.02481 Val Loss = 2.98783
2023-04-18 18:23:51.374642 Epoch 37  	Train Loss = 3.01551 Val Loss = 2.99840
2023-04-18 18:25:11.682861 Epoch 38  	Train Loss = 3.01286 Val Loss = 2.98369
2023-04-18 18:26:30.462185 Epoch 39  	Train Loss = 3.00574 Val Loss = 2.97407
2023-04-18 18:27:48.542116 Epoch 40  	Train Loss = 2.99955 Val Loss = 2.98507
2023-04-18 18:29:06.866076 Epoch 41  	Train Loss = 2.98392 Val Loss = 2.97395
2023-04-18 18:30:25.264434 Epoch 42  	Train Loss = 2.98196 Val Loss = 2.96225
2023-04-18 18:31:43.960576 Epoch 43  	Train Loss = 2.97985 Val Loss = 2.96990
2023-04-18 18:33:03.493864 Epoch 44  	Train Loss = 2.97905 Val Loss = 2.96171
2023-04-18 18:34:23.283848 Epoch 45  	Train Loss = 2.97864 Val Loss = 2.97219
2023-04-18 18:35:42.959706 Epoch 46  	Train Loss = 2.97759 Val Loss = 2.97063
2023-04-18 18:37:03.053077 Epoch 47  	Train Loss = 2.97800 Val Loss = 2.96997
2023-04-18 18:38:24.198722 Epoch 48  	Train Loss = 2.97913 Val Loss = 2.96687
2023-04-18 18:39:45.575519 Epoch 49  	Train Loss = 2.98082 Val Loss = 2.96864
2023-04-18 18:41:04.835760 Epoch 50  	Train Loss = 2.98068 Val Loss = 2.97175
2023-04-18 18:42:23.215449 Epoch 51  	Train Loss = 2.97930 Val Loss = 2.96340
2023-04-18 18:43:41.679515 Epoch 52  	Train Loss = 2.97816 Val Loss = 2.96090
2023-04-18 18:45:00.176876 Epoch 53  	Train Loss = 2.97724 Val Loss = 2.96472
2023-04-18 18:46:18.720228 Epoch 54  	Train Loss = 2.97731 Val Loss = 2.96665
2023-04-18 18:47:37.205927 Epoch 55  	Train Loss = 2.97422 Val Loss = 2.96091
2023-04-18 18:48:55.697470 Epoch 56  	Train Loss = 2.97363 Val Loss = 2.97020
2023-04-18 18:50:14.104244 Epoch 57  	Train Loss = 2.97316 Val Loss = 2.96196
2023-04-18 18:51:32.013808 Epoch 58  	Train Loss = 2.97124 Val Loss = 2.96755
2023-04-18 18:52:49.317132 Epoch 59  	Train Loss = 2.96849 Val Loss = 2.96368
2023-04-18 18:54:06.704144 Epoch 60  	Train Loss = 2.96619 Val Loss = 2.96094
2023-04-18 18:55:24.739432 Epoch 61  	Train Loss = 2.96535 Val Loss = 2.95669
2023-04-18 18:56:43.141574 Epoch 62  	Train Loss = 2.96299 Val Loss = 2.94868
2023-04-18 18:58:01.444066 Epoch 63  	Train Loss = 2.96341 Val Loss = 2.95326
2023-04-18 18:59:19.884276 Epoch 64  	Train Loss = 2.96074 Val Loss = 2.95356
2023-04-18 19:00:39.331694 Epoch 65  	Train Loss = 2.96199 Val Loss = 2.95484
2023-04-18 19:01:59.000581 Epoch 66  	Train Loss = 2.96176 Val Loss = 2.94873
2023-04-18 19:03:17.404339 Epoch 67  	Train Loss = 2.96105 Val Loss = 2.95134
2023-04-18 19:04:34.518047 Epoch 68  	Train Loss = 2.95988 Val Loss = 2.94987
2023-04-18 19:05:51.888790 Epoch 69  	Train Loss = 2.96005 Val Loss = 2.95473
2023-04-18 19:07:09.515079 Epoch 70  	Train Loss = 2.95920 Val Loss = 2.95228
2023-04-18 19:08:27.445749 Epoch 71  	Train Loss = 2.95872 Val Loss = 2.95415
2023-04-18 19:09:45.812257 Epoch 72  	Train Loss = 2.95613 Val Loss = 2.95341
2023-04-18 19:11:04.226408 Epoch 73  	Train Loss = 2.95517 Val Loss = 2.95098
2023-04-18 19:12:22.619229 Epoch 74  	Train Loss = 2.95467 Val Loss = 2.94788
2023-04-18 19:13:41.126389 Epoch 75  	Train Loss = 2.95461 Val Loss = 2.94691
2023-04-18 19:15:00.710067 Epoch 76  	Train Loss = 2.95387 Val Loss = 2.94866
2023-04-18 19:16:20.570407 Epoch 77  	Train Loss = 2.95202 Val Loss = 2.95629
2023-04-18 19:17:39.290076 Epoch 78  	Train Loss = 2.95063 Val Loss = 2.95078
2023-04-18 19:18:57.098064 Epoch 79  	Train Loss = 2.95069 Val Loss = 2.94460
2023-04-18 19:20:15.105990 Epoch 80  	Train Loss = 2.95037 Val Loss = 2.94660
2023-04-18 19:21:33.310627 Epoch 81  	Train Loss = 2.94792 Val Loss = 2.94979
2023-04-18 19:22:51.634147 Epoch 82  	Train Loss = 2.94783 Val Loss = 2.95444
2023-04-18 19:24:09.918703 Epoch 83  	Train Loss = 2.94729 Val Loss = 2.95536
2023-04-18 19:25:28.338609 Epoch 84  	Train Loss = 2.94718 Val Loss = 2.94741
2023-04-18 19:26:46.736481 Epoch 85  	Train Loss = 2.94663 Val Loss = 2.95237
2023-04-18 19:28:05.173220 Epoch 86  	Train Loss = 2.94761 Val Loss = 2.94647
2023-04-18 19:29:24.753324 Epoch 87  	Train Loss = 2.94753 Val Loss = 2.95425
2023-04-18 19:30:44.523577 Epoch 88  	Train Loss = 2.94772 Val Loss = 2.95232
2023-04-18 19:32:03.164357 Epoch 89  	Train Loss = 2.94733 Val Loss = 2.94761
2023-04-18 19:33:20.394943 Epoch 90  	Train Loss = 2.94675 Val Loss = 2.94880
2023-04-18 19:34:37.806847 Epoch 91  	Train Loss = 2.94751 Val Loss = 2.94626
2023-04-18 19:35:55.993934 Epoch 92  	Train Loss = 2.94661 Val Loss = 2.94768
2023-04-18 19:37:14.452485 Epoch 93  	Train Loss = 2.94680 Val Loss = 2.95032
2023-04-18 19:38:32.904794 Epoch 94  	Train Loss = 2.94611 Val Loss = 2.95086
2023-04-18 19:39:51.392420 Epoch 95  	Train Loss = 2.94638 Val Loss = 2.95268
2023-04-18 19:41:09.799916 Epoch 96  	Train Loss = 2.94581 Val Loss = 2.95231
2023-04-18 19:42:28.170296 Epoch 97  	Train Loss = 2.94509 Val Loss = 2.94353
2023-04-18 19:43:46.437589 Epoch 98  	Train Loss = 2.94565 Val Loss = 2.94685
2023-04-18 19:45:04.319447 Epoch 99  	Train Loss = 2.94529 Val Loss = 2.95467
2023-04-18 19:46:21.706027 Epoch 100  	Train Loss = 2.94541 Val Loss = 2.95475
2023-04-18 19:47:38.168873 Epoch 101  	Train Loss = 2.94527 Val Loss = 2.94426
2023-04-18 19:48:54.930307 Epoch 102  	Train Loss = 2.94524 Val Loss = 2.94701
2023-04-18 19:50:12.184316 Epoch 103  	Train Loss = 2.94546 Val Loss = 2.94386
2023-04-18 19:51:29.977389 Epoch 104  	Train Loss = 2.94549 Val Loss = 2.94351
2023-04-18 19:52:48.386188 Epoch 105  	Train Loss = 2.94506 Val Loss = 2.94415
2023-04-18 19:54:07.106484 Epoch 106  	Train Loss = 2.94476 Val Loss = 2.95447
2023-04-18 19:55:25.598806 Epoch 107  	Train Loss = 2.94570 Val Loss = 2.94458
2023-04-18 19:56:44.033861 Epoch 108  	Train Loss = 2.94490 Val Loss = 2.95765
2023-04-18 19:58:02.680305 Epoch 109  	Train Loss = 2.94548 Val Loss = 2.94516
2023-04-18 19:59:21.181559 Epoch 110  	Train Loss = 2.94461 Val Loss = 2.94610
2023-04-18 20:00:39.523725 Epoch 111  	Train Loss = 2.94601 Val Loss = 2.95066
2023-04-18 20:01:56.850408 Epoch 112  	Train Loss = 2.94618 Val Loss = 2.95330
2023-04-18 20:03:14.167636 Epoch 113  	Train Loss = 2.94547 Val Loss = 2.94899
2023-04-18 20:04:31.749412 Epoch 114  	Train Loss = 2.94554 Val Loss = 2.94619
2023-04-18 20:05:49.839352 Epoch 115  	Train Loss = 2.94414 Val Loss = 2.95069
2023-04-18 20:07:08.332510 Epoch 116  	Train Loss = 2.94379 Val Loss = 2.94822
2023-04-18 20:08:27.445255 Epoch 117  	Train Loss = 2.94457 Val Loss = 2.94755
2023-04-18 20:09:46.244154 Epoch 118  	Train Loss = 2.94434 Val Loss = 2.94338
2023-04-18 20:11:04.747454 Epoch 119  	Train Loss = 2.94358 Val Loss = 2.94695
2023-04-18 20:12:23.692050 Epoch 120  	Train Loss = 2.94425 Val Loss = 2.94222
2023-04-18 20:13:42.508784 Epoch 121  	Train Loss = 2.94505 Val Loss = 2.95094
2023-04-18 20:15:00.957327 Epoch 122  	Train Loss = 2.94528 Val Loss = 2.94584
2023-04-18 20:16:18.337832 Epoch 123  	Train Loss = 2.94404 Val Loss = 2.94183
2023-04-18 20:17:35.707349 Epoch 124  	Train Loss = 2.94460 Val Loss = 2.94601
2023-04-18 20:18:53.450024 Epoch 125  	Train Loss = 2.94439 Val Loss = 2.94710
2023-04-18 20:20:11.623658 Epoch 126  	Train Loss = 2.94439 Val Loss = 2.95651
2023-04-18 20:21:30.186958 Epoch 127  	Train Loss = 2.94383 Val Loss = 2.94083
2023-04-18 20:22:49.146324 Epoch 128  	Train Loss = 2.94490 Val Loss = 2.94522
2023-04-18 20:24:07.761319 Epoch 129  	Train Loss = 2.94327 Val Loss = 2.94499
2023-04-18 20:25:26.229720 Epoch 130  	Train Loss = 2.94437 Val Loss = 2.94786
2023-04-18 20:26:44.977519 Epoch 131  	Train Loss = 2.94433 Val Loss = 2.95238
2023-04-18 20:28:03.760090 Epoch 132  	Train Loss = 2.94312 Val Loss = 2.94664
2023-04-18 20:29:22.251487 Epoch 133  	Train Loss = 2.94354 Val Loss = 2.94496
2023-04-18 20:30:39.632069 Epoch 134  	Train Loss = 2.94296 Val Loss = 2.94623
2023-04-18 20:31:56.911633 Epoch 135  	Train Loss = 2.94384 Val Loss = 2.94853
2023-04-18 20:33:14.490112 Epoch 136  	Train Loss = 2.94291 Val Loss = 2.94431
2023-04-18 20:34:32.413663 Epoch 137  	Train Loss = 2.94285 Val Loss = 2.95435
2023-04-18 20:35:50.813989 Epoch 138  	Train Loss = 2.94366 Val Loss = 2.94963
2023-04-18 20:37:09.464511 Epoch 139  	Train Loss = 2.94327 Val Loss = 2.94654
2023-04-18 20:38:27.929916 Epoch 140  	Train Loss = 2.94341 Val Loss = 2.94867
2023-04-18 20:39:46.312405 Epoch 141  	Train Loss = 2.94299 Val Loss = 2.94862
2023-04-18 20:41:04.793374 Epoch 142  	Train Loss = 2.94200 Val Loss = 2.94731
2023-04-18 20:42:23.233312 Epoch 143  	Train Loss = 2.94194 Val Loss = 2.95135
2023-04-18 20:43:41.631158 Epoch 144  	Train Loss = 2.94307 Val Loss = 2.94350
2023-04-18 20:44:58.910559 Epoch 145  	Train Loss = 2.94316 Val Loss = 2.95557
2023-04-18 20:46:16.058236 Epoch 146  	Train Loss = 2.94243 Val Loss = 2.94520
2023-04-18 20:47:33.712028 Epoch 147  	Train Loss = 2.94276 Val Loss = 2.94581
Early stopping at epoch: 147
Best at epoch 127:
Train Loss = 2.94383
Train RMSE = 5.80000, MAE = 2.94195, MAPE = 7.94299
Val Loss = 2.94083
Val RMSE = 6.06726, MAE = 2.97655, MAPE = 8.42755
--------- Test ---------
All Steps RMSE = 6.42545, MAE = 3.22626, MAPE = 9.06991
Step 1 RMSE = 4.28152, MAE = 2.44249, MAPE = 6.17535
Step 2 RMSE = 4.99202, MAE = 2.69254, MAPE = 7.03365
Step 3 RMSE = 5.47109, MAE = 2.87413, MAPE = 7.70878
Step 4 RMSE = 5.84426, MAE = 3.02727, MAPE = 8.29247
Step 5 RMSE = 6.16798, MAE = 3.15499, MAPE = 8.80436
Step 6 RMSE = 6.44474, MAE = 3.26140, MAPE = 9.22176
Step 7 RMSE = 6.69060, MAE = 3.35066, MAPE = 9.57232
Step 8 RMSE = 6.89590, MAE = 3.43007, MAPE = 9.86449
Step 9 RMSE = 7.08667, MAE = 3.50418, MAPE = 10.13980
Step 10 RMSE = 7.26217, MAE = 3.57845, MAPE = 10.40042
Step 11 RMSE = 7.43320, MAE = 3.65679, MAPE = 10.66513
Step 12 RMSE = 7.61514, MAE = 3.74220, MAPE = 10.96077
Inference time: 4.65 s
